{% extends 'base.html.twig' %}

{% block title %}Corps Enseignant{% endblock %}

{% block body %}

<section class="max-w-5xl w-full mr-auto">
    {# 1. En-tête de la page #}
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
        <div>
            <h1 class="font-medium text-[#1F384C] text-[26px] mb-[10px]">
                Corps enseignant
            </h1>
            <p class="font-medium font-[16px] text-gray-600">
                Gérez ici la liste des enseignants et leurs affectations.
            </p>
        </div>
        
        {# Bouton Ajouter (Utilisation du composant Button) #}
        <div>
            {% include 'composants/button.html.twig' with {
                'label': 'Ajouter un enseignant',
                'url': '#', 
                'type': 'confirm',
                'icon': 'fa fa-plus' 
            } %}
        </div>
    </div>

    {# 2. Zone de Filtres #}
    <div class="mt-[40px]">
        <p class="text-[#FFBD01] font-medium text-[20px] pb-[10px]">
            Filtres
        </p>

        {{ form_start(form, {'attr': {'class': 'flex flex-col lg:flex-row lg:items-end gap-3'}}) }}

        {# Champ Nom #}
        <div class="flex flex-col w-full md:w-auto md:mr-4">
            {% include "composants/form_champ_text.html.twig" with {
                'label': 'Nom de famille',
                'field': form.lastName
            } %}
        </div>

        {# Champ Prénom #}
        <div class="flex flex-col w-full md:w-auto md:mr-4">
            {% include "composants/form_champ_text.html.twig" with {
                'label': 'Prénom',
                'field': form.firstName
            } %}
        </div>

        {# Champ Email #}
        <div class="flex flex-col w-full md:w-auto md:mr-4">
            {% include "composants/form_champ_text.html.twig" with {
                'label': 'Email',
                'field': form.email
            } %}
        </div>

        {# Bouton Filtrer (Style 'warning' jaune comme sur teaching_block) #}
        <div class="mt-2 md:mt-0">
            {% include 'composants/button.html.twig' with {
                'label': 'Filtrer',
                'type': 'warning'
            } %}
        </div>
        {{ form_end(form) }}
    </div>

    <hr class="mt-[20px] text-[#FFBD01]">

    {# 3. Tableau des résultats #}
    <div class="mt-[20px]">
        <p class="font-medium text-[20px] mb-4">
            {# On gère l'affichage du nombre selon si c'est une pagination ou un tableau simple #}
            {{ instructors|length }} enseignants trouvés
        </p>

        {# Utilisation du composant TABLE via EMBED #}
        {% embed 'composants/table.html.twig' with {
            headers: ['Nom de famille', 'Prénom', 'Modules enseignés', 'Nombre d\'heures', 'Actions']
        } %}
            {% block body %}
                {% for instructor in instructors %}
                    <tr class="hover:bg-gray-50 transition-colors border-b border-gray-100 last:border-0">
                        {# Nom #}
                        <td class="px-[25px] py-[20px] text-[#1F384C] text-[14px] font-medium">
                            {{ instructor.user.lastName }}
                        </td>
                        
                        {# Prénom #}
                        <td class="px-[25px] py-[20px] text-[#1F384C] text-[14px] font-medium">
                            {{ instructor.user.firstName }}
                        </td>
                        
                        {# Modules (via notre helper getModuleNamesString) #}
                        <td class="px-[25px] py-[20px] text-[#1F384C] text-[14px] font-medium">
                            {{ instructor.moduleNamesString }}
                        </td>
                        
                        {# Heures (via notre helper getTotalHours) #}
                        <td class="px-[25px] py-[20px] text-[#1F384C] text-[14px] font-medium">
                            {{ instructor.totalHours }} h
                        </td>
                        
                        {# Actions (Style inspiré de teaching_block: icône + lien texte) #}
                        <td class="px-[25px] py-[20px] flex items-center gap-2">
                            <img class="w-[16px] h-[16px]" src="{{ asset('img/oeil (1).png') }}" alt="Voir">
                            {# Vous pourrez mettre le vrai lien ici plus tard #}
                            <a href="#" class="text-[#1F384C] text-[14px] font-medium hover:underline">
                                Consulter
                            </a>
                        </td>
                    </tr>
                {% else %}
                    <tr>
                        <td colspan="5" class="px-[25px] py-[20px] text-[14px] text-center text-gray-500">
                            Aucun enseignant trouvé.
                        </td>
                    </tr>
                {% endfor %}
            {% endblock %}
        {% endembed %}
    </div>

    {# 4. Pagination Manuelle (Design personnalisé pour s'intégrer) #}
    {% if maxPages > 1 %}
        <div class="flex justify-center mt-8 gap-2">
            {# Bouton Précédent #}
            <a href="{{ path('app_instructor_index', app.request.query.all|merge({'page': currentPage - 1})) }}" 
               class="px-4 py-2 text-sm font-medium rounded-md border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 {% if currentPage <= 1 %}opacity-50 pointer-events-none{% endif %}">
               Précédent
            </a>

            <span class="px-4 py-2 text-sm font-medium text-gray-700">
                Page {{ currentPage }} / {{ maxPages }}
            </span>

            {# Bouton Suivant #}
            <a href="{{ path('app_instructor_index', app.request.query.all|merge({'page': currentPage + 1})) }}" 
               class="px-4 py-2 text-sm font-medium rounded-md border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 {% if currentPage >= maxPages %}opacity-50 pointer-events-none{% endif %}">
               Suivant
            </a>
        </div>
    {% endif %}

</section>

{% endblock %}